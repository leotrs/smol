{% extends "base.html" %}

{% block title %}Search Results - SMOL{% endblock %}

{% block content %}
<div class="search-header">
    <div>
        <h1>Search Results</h1>
        <p>Found <strong {% if results_capped %}hx-get="/search/count?{% for key, value in query_params.items() %}{% if value is not string and value is iterable %}{% for v in value %}{{ key }}={{ v }}&{% endfor %}{% else %}{{ key }}={{ value }}&{% endif %}{% endfor %}" hx-trigger="load" hx-swap="innerHTML"{% endif %}>{% if results_capped %}1,000+{% else %}{{ "{:,}".format(total_count) }}{% endif %}</strong> graph{% if total_count != 1 %}s{% endif %} matching your criteria.</p>
    </div>
    {% if total_count > 0 %}
    <div class="export-buttons">
        <a href="/search/export?{% for key, value in query_params.items() %}{% if value is not string and value is iterable %}{% for v in value %}{{ key }}={{ v }}&{% endfor %}{% else %}{{ key }}={{ value }}&{% endif %}{% endfor %}limit={{ limit }}&format=csv" class="export-btn" download>
            üìÑ CSV
        </a>
        <a href="/search/export?{% for key, value in query_params.items() %}{% if value is not string and value is iterable %}{% for v in value %}{{ key }}={{ v }}&{% endfor %}{% else %}{{ key }}={{ value }}&{% endif %}{% endfor %}limit={{ limit }}&format=json" class="export-btn" download>
            üìã JSON
        </a>
        <a href="/search/export?{% for key, value in query_params.items() %}{% if value is not string and value is iterable %}{% for v in value %}{{ key }}={{ v }}&{% endfor %}{% else %}{{ key }}={{ value }}&{% endif %}{% endfor %}limit={{ limit }}&format=graph6" class="export-btn" download>
            üî¢ graph6
        </a>
    </div>
    {% endif %}
</div>

{% if total_count > 0 %}

{% if results_capped %}
<!-- Embed all results as JSON for client-side sorting/pagination -->
<script>
window.searchData = {{ all_graphs | tojson }};
</script>

<div class="results-cap-warning">
    <strong>‚ö†Ô∏è Showing first 1,000 of 1,000+ results.</strong>
    For the full dataset, use the <a href="#api-equivalent">API</a> or export functionality above.
</div>

<!-- Alpine.js powered client-side sorting and pagination -->
<div x-data="{
    allGraphs: window.searchData || [],
    sortBy: '{{ sort_by }}',
    sortOrder: '{{ sort_order }}',
    currentPage: 1,
    perPage: {{ limit }},
    columnPickerOpen: false,
    allColumns: [
        { key: 'graph6', label: 'graph6', sortable: true, fixed: true },
        { key: 'n', label: 'n', sortable: true, default: true },
        { key: 'm', label: 'm', sortable: true, default: true },
        { key: 'tags', label: 'Tags', sortable: false, default: true },
        { key: 'diameter', label: 'Diameter', sortable: true, default: true },
        { key: 'girth', label: 'Girth', sortable: true, default: true },
        { key: 'radius', label: 'Radius', sortable: true, default: false },
        { key: 'min_degree', label: 'Min Degree', sortable: true, default: false },
        { key: 'max_degree', label: 'Max Degree', sortable: true, default: false },
        { key: 'triangle_count', label: 'Triangles', sortable: true, default: false },
        { key: 'clique_number', label: 'Clique #', sortable: true, default: false },
        { key: 'chromatic_number', label: 'Chromatic #', sortable: true, default: false },
    ],
    get availableColumns() {
        return this.allColumns;
    },
    get toggleableColumns() {
        return this.allColumns.filter(c => !c.fixed);
    },
    get visibleColumnCount() {
        return this.allColumns.filter(c => this.isColumnVisible(c.key)).length;
    },
    visibleColumns: [],
    init() {
        const stored = localStorage.getItem('smol_visible_columns');
        if (stored) {
            this.visibleColumns = JSON.parse(stored);
        } else {
            this.visibleColumns = this.allColumns.filter(c => c.default).map(c => c.key);
        }
        // Always ensure graph6 is visible
        if (!this.visibleColumns.includes('graph6')) {
            this.visibleColumns.unshift('graph6');
        }
    },
    isColumnVisible(key) {
        const col = this.allColumns.find(c => c.key === key);
        return col?.fixed || this.visibleColumns.includes(key);
    },
    toggleColumn(key) {
        if (this.visibleColumns.includes(key)) {
            this.visibleColumns = this.visibleColumns.filter(k => k !== key);
        } else {
            this.visibleColumns.push(key);
        }
        localStorage.setItem('smol_visible_columns', JSON.stringify(this.visibleColumns));
    },
    getValue(graph, key) {
        if (key === 'graph6') return graph.graph6;
        if (key === 'n') return graph.n;
        if (key === 'm') return graph.m;
        if (key === 'tags') return graph.tags?.join(',') || '';
        return graph.properties?.[key];
    },
    getAllTags(graph) {
        const tags = graph.tags ? [...graph.tags] : [];
        // Add boolean properties as tags
        if (graph.properties?.is_bipartite) tags.push('bipartite');
        if (graph.properties?.is_planar) tags.push('planar');
        if (graph.properties?.is_regular) tags.push('regular');
        return tags.sort();
    },
    get sortedGraphs() {
        let sorted = [...this.allGraphs];
        const reverse = this.sortOrder === 'desc';

        if (this.sortBy === 'graph6' || this.sortBy === 'tags') {
            sorted.sort((a, b) => {
                const aVal = this.getValue(a, this.sortBy) || '';
                const bVal = this.getValue(b, this.sortBy) || '';
                return reverse ? bVal.localeCompare(aVal) : aVal.localeCompare(bVal);
            });
        } else {
            sorted.sort((a, b) => {
                const aVal = this.getValue(a, this.sortBy) ?? Infinity;
                const bVal = this.getValue(b, this.sortBy) ?? Infinity;
                return reverse ? bVal - aVal : aVal - bVal;
            });
        }

        return sorted;
    },
    get paginatedGraphs() {
        const start = (this.currentPage - 1) * this.perPage;
        const end = start + this.perPage;
        return this.sortedGraphs.slice(start, end);
    },
    get totalPages() {
        return Math.ceil(this.sortedGraphs.length / this.perPage);
    },
    toggleSort(column) {
        if (this.sortBy === column) {
            this.sortOrder = this.sortOrder === 'asc' ? 'desc' : 'asc';
        } else {
            this.sortBy = column;
            this.sortOrder = 'asc';
        }
        this.currentPage = 1;
    }
}">

<!-- Column Picker -->
<div class="column-picker" style="margin-bottom: 1rem;">
    <div style="position: relative; display: inline-block;">
        <button @click="columnPickerOpen = !columnPickerOpen" class="secondary" style="font-size: 0.9rem;">
            ‚öôÔ∏è Columns (<span x-text="visibleColumnCount"></span>)
        </button>
        <div x-show="columnPickerOpen"
             @click.outside="columnPickerOpen = false"
             x-transition
             style="position: absolute; top: 100%; left: 0; background: var(--pico-card-background-color); border: 1px solid var(--pico-muted-border-color); border-radius: var(--pico-border-radius); padding: 1rem; min-width: 200px; z-index: 1000; box-shadow: var(--pico-card-box-shadow); margin-top: 0.25rem;">
            <div style="font-weight: bold; margin-bottom: 0.5rem; font-size: 0.9rem;">Select Columns:</div>
            <template x-for="col in toggleableColumns" :key="col.key">
                <label style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem; cursor: pointer; font-size: 0.85rem;">
                    <input type="checkbox"
                           :checked="isColumnVisible(col.key)"
                           @change="toggleColumn(col.key)"
                           style="margin: 0; width: auto;">
                    <span x-text="col.label"></span>
                </label>
            </template>
        </div>
    </div>
</div>

<p class="results-range">
    Showing <span x-text="((currentPage - 1) * perPage + 1).toLocaleString()"></span>-<span x-text="Math.min(currentPage * perPage, sortedGraphs.length).toLocaleString()"></span> of <span x-text="sortedGraphs.length.toLocaleString()"></span>
</p>

<!-- Results Table -->
<div class="table-wrapper">
<table>
    <thead>
        <tr>
            <template x-for="col in availableColumns" :key="col.key">
                <th x-show="isColumnVisible(col.key)">
                    <template x-if="col.sortable">
                        <span @click="toggleSort(col.key)" style="cursor: pointer;">
                            <span x-text="col.label"></span>
                            <span x-show="sortBy === col.key" class="sort-indicator" x-text="sortOrder === 'asc' ? '‚Üë' : '‚Üì'"></span>
                        </span>
                    </template>
                    <template x-if="!col.sortable">
                        <span x-text="col.label"></span>
                    </template>
                </th>
            </template>
        </tr>
    </thead>
    <tbody>
        <template x-for="g in paginatedGraphs" :key="g.graph6">
        <tr>
            <template x-for="col in availableColumns" :key="col.key">
                <td x-show="isColumnVisible(col.key)">
                    <!-- graph6 column: link with code -->
                    <template x-if="col.key === 'graph6'">
                        <a :href="'/graph/' + encodeURIComponent(g.graph6)"><code x-text="g.graph6"></code></a>
                    </template>
                    <!-- tags column: array of badges (includes boolean properties) -->
                    <template x-if="col.key === 'tags'">
                        <span>
                            <template x-if="getAllTags(g).length > 0">
                                <span>
                                    <template x-for="tag in getAllTags(g)" :key="tag">
                                        <span class="tag tag-sm" x-text="tag"></span>
                                    </template>
                                </span>
                            </template>
                            <template x-if="getAllTags(g).length === 0">
                                <span>-</span>
                            </template>
                        </span>
                    </template>
                    <!-- Numeric columns from properties -->
                    <template x-if="col.key !== 'graph6' && col.key !== 'tags' && col.key !== 'n' && col.key !== 'm'">
                        <span x-text="getValue(g, col.key) ?? '-'"></span>
                    </template>
                    <!-- n and m columns: direct values -->
                    <template x-if="col.key === 'n' || col.key === 'm'">
                        <span x-text="getValue(g, col.key)"></span>
                    </template>
                </td>
            </template>
        </tr>
        </template>
    </tbody>
</table>
</div>

<!-- Client-side Pagination -->
<div class="pagination" x-show="totalPages > 1">
    <button @click="currentPage > 1 && currentPage--" :disabled="currentPage === 1" class="page-link" :style="currentPage === 1 ? 'opacity: 0.5; cursor: not-allowed;' : ''">&laquo; Previous</button>

    <template x-for="p in Array.from({length: totalPages}, (_, i) => i + 1)" :key="p">
        <span>
            <template x-if="p === 1 || p === totalPages || (p >= currentPage - 2 && p <= currentPage + 2)">
                <button @click="currentPage = p"
                        :class="p === currentPage ? 'page-current' : 'page-link'"
                        x-text="p"
                        :style="p === currentPage ? 'font-weight: bold;' : ''"></button>
            </template>
            <template x-if="p === currentPage - 3 || p === currentPage + 3">
                <span class="page-ellipsis">...</span>
            </template>
        </span>
    </template>

    <button @click="currentPage < totalPages && currentPage++" :disabled="currentPage === totalPages" class="page-link" :style="currentPage === totalPages ? 'opacity: 0.5; cursor: not-allowed;' : ''">Next &raquo;</button>
</div>

</div> <!-- Close Alpine.js x-data div -->

{% else %}
<!-- Server-side sorting and pagination for small result sets -->
<div x-data="{
    columnPickerOpen: false,
    allColumns: [
        { key: 'graph6', label: 'graph6', sortable: true, fixed: true },
        { key: 'n', label: 'n', sortable: true, default: true },
        { key: 'm', label: 'm', sortable: true, default: true },
        { key: 'tags', label: 'Tags', sortable: false, default: true },
        { key: 'diameter', label: 'Diameter', sortable: true, default: true },
        { key: 'girth', label: 'Girth', sortable: true, default: true },
        { key: 'radius', label: 'Radius', sortable: true, default: false },
        { key: 'min_degree', label: 'Min Degree', sortable: true, default: false },
        { key: 'max_degree', label: 'Max Degree', sortable: true, default: false },
        { key: 'triangle_count', label: 'Triangles', sortable: true, default: false },
        { key: 'clique_number', label: 'Clique #', sortable: true, default: false },
        { key: 'chromatic_number', label: 'Chromatic #', sortable: true, default: false },
    ],
    get availableColumns() {
        return this.allColumns;
    },
    get toggleableColumns() {
        return this.allColumns.filter(c => !c.fixed);
    },
    get visibleColumnCount() {
        return this.allColumns.filter(c => this.isColumnVisible(c.key)).length;
    },
    visibleColumns: [],
    init() {
        const stored = localStorage.getItem('smol_visible_columns');
        if (stored) {
            this.visibleColumns = JSON.parse(stored);
        } else {
            this.visibleColumns = this.allColumns.filter(c => c.default).map(c => c.key);
        }
        // Always ensure graph6 is visible
        if (!this.visibleColumns.includes('graph6')) {
            this.visibleColumns.unshift('graph6');
        }
    },
    isColumnVisible(key) {
        const col = this.allColumns.find(c => c.key === key);
        return col?.fixed || this.visibleColumns.includes(key);
    },
    toggleColumn(key) {
        if (this.visibleColumns.includes(key)) {
            this.visibleColumns = this.visibleColumns.filter(k => k !== key);
        } else {
            this.visibleColumns.push(key);
        }
        localStorage.setItem('smol_visible_columns', JSON.stringify(this.visibleColumns));
    },
    getValue(graph, key) {
        if (key === 'graph6') return graph.graph6;
        if (key === 'n') return graph.n;
        if (key === 'm') return graph.m;
        if (key === 'tags') return graph.tags?.join(',') || '';
        return graph.properties?.[key];
    },
    getAllTags(graph) {
        const tags = graph.tags ? [...graph.tags] : [];
        // Add boolean properties as tags
        if (graph.properties?.is_bipartite) tags.push('bipartite');
        if (graph.properties?.is_planar) tags.push('planar');
        if (graph.properties?.is_regular) tags.push('regular');
        return tags.sort();
    }
}">

<!-- Column Picker -->
<div class="column-picker" style="margin-bottom: 1rem;">
    <div style="position: relative; display: inline-block;">
        <button @click="columnPickerOpen = !columnPickerOpen" class="secondary" style="font-size: 0.9rem;">
            ‚öôÔ∏è Columns (<span x-text="visibleColumnCount"></span>)
        </button>
        <div x-show="columnPickerOpen"
             @click.outside="columnPickerOpen = false"
             x-transition
             style="position: absolute; top: 100%; left: 0; background: var(--pico-card-background-color); border: 1px solid var(--pico-muted-border-color); border-radius: var(--pico-border-radius); padding: 1rem; min-width: 200px; z-index: 1000; box-shadow: var(--pico-card-box-shadow); margin-top: 0.25rem;">
            <div style="font-weight: bold; margin-bottom: 0.5rem; font-size: 0.9rem;">Select Columns:</div>
            <template x-for="col in toggleableColumns" :key="col.key">
                <label style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem; cursor: pointer; font-size: 0.85rem;">
                    <input type="checkbox"
                           :checked="isColumnVisible(col.key)"
                           @change="toggleColumn(col.key)"
                           style="margin: 0; width: auto;">
                    <span x-text="col.label"></span>
                </label>
            </template>
        </div>
    </div>
</div>

<p class="results-range">
    Showing {{ "{:,}".format(start_idx) }}-{{ "{:,}".format(end_idx) }} of {{ "{:,}".format(total_count) }}
</p>

<!-- Results Table -->
<script>
window.serverGraphs = {{ graphs | tojson }};
</script>
<div class="table-wrapper">
<table>
    <thead>
        <tr>
            <template x-for="col in availableColumns" :key="col.key">
                <th x-show="isColumnVisible(col.key)">
                    <template x-if="col.sortable">
                        <a :href="`/search?{% for key, value in query_params.items() %}{% if value is not string and value is iterable %}{% for v in value %}{{ key }}={{ v }}&{% endfor %}{% else %}{{ key }}={{ value }}&{% endif %}{% endfor %}page={{ page }}&limit={{ limit }}&sort_by=${col.key}&sort_order={% if sort_by == '${col.key}' and sort_order == 'asc' %}desc{% else %}asc{% endif %}`">
                            <span x-text="col.label"></span>
                            <span x-show="'{{ sort_by }}' === col.key" class="sort-indicator">{{ '‚Üë' if sort_order == 'asc' else '‚Üì' }}</span>
                        </a>
                    </template>
                    <template x-if="!col.sortable">
                        <span x-text="col.label"></span>
                    </template>
                </th>
            </template>
        </tr>
    </thead>
    <tbody>
        <template x-for="g in window.serverGraphs" :key="g.graph6">
        <tr>
            <template x-for="col in availableColumns" :key="col.key">
                <td x-show="isColumnVisible(col.key)">
                    <!-- graph6 column: link with code -->
                    <template x-if="col.key === 'graph6'">
                        <a :href="'/graph/' + encodeURIComponent(g.graph6)"><code x-text="g.graph6"></code></a>
                    </template>
                    <!-- tags column: array of badges (includes boolean properties) -->
                    <template x-if="col.key === 'tags'">
                        <span>
                            <template x-if="getAllTags(g).length > 0">
                                <span>
                                    <template x-for="tag in getAllTags(g)" :key="tag">
                                        <span class="tag tag-sm" x-text="tag"></span>
                                    </template>
                                </span>
                            </template>
                            <template x-if="getAllTags(g).length === 0">
                                <span>-</span>
                            </template>
                        </span>
                    </template>
                    <!-- Numeric columns from properties -->
                    <template x-if="col.key !== 'graph6' && col.key !== 'tags' && col.key !== 'n' && col.key !== 'm'">
                        <span x-text="getValue(g, col.key) ?? '-'"></span>
                    </template>
                    <!-- n and m columns: direct values -->
                    <template x-if="col.key === 'n' || col.key === 'm'">
                        <span x-text="getValue(g, col.key)"></span>
                    </template>
                </td>
            </template>
        </tr>
        </template>
    </tbody>
</table>
</div>

<!-- Server-side Pagination -->
{% if total_pages > 1 %}
<div class="pagination">
    {% if has_prev %}
    <a href="/search?{% for key, value in query_params.items() %}{% if value is not string and value is iterable %}{% for v in value %}{{ key }}={{ v }}&{% endfor %}{% else %}{{ key }}={{ value }}&{% endif %}{% endfor %}page={{ page - 1 }}&limit={{ limit }}&sort_by={{ sort_by }}&sort_order={{ sort_order }}" class="page-link">&laquo; Previous</a>
    {% endif %}

    {% for p in range(1, total_pages + 1) %}
        {% if p == 1 or p == total_pages or (p >= page - 2 and p <= page + 2) %}
            {% if p == page %}
                <span class="page-current">{{ p }}</span>
            {% else %}
                <a href="/search?{% for key, value in query_params.items() %}{% if value is not string and value is iterable %}{% for v in value %}{{ key }}={{ v }}&{% endfor %}{% else %}{{ key }}={{ value }}&{% endif %}{% endfor %}page={{ p }}&limit={{ limit }}&sort_by={{ sort_by }}&sort_order={{ sort_order }}" class="page-link">{{ p }}</a>
            {% endif %}
        {% elif p == page - 3 or p == page + 3 %}
            <span class="page-ellipsis">...</span>
        {% endif %}
    {% endfor %}

    {% if has_next %}
    <a href="/search?{% for key, value in query_params.items() %}{% if value is not string and value is iterable %}{% for v in value %}{{ key }}={{ v }}&{% endfor %}{% else %}{{ key }}={{ value }}&{% endif %}{% endfor %}page={{ page + 1 }}&limit={{ limit }}&sort_by={{ sort_by }}&sort_order={{ sort_order }}" class="page-link">Next &raquo;</a>
    {% endif %}
</div>
{% endif %}

</div> <!-- Close Alpine.js x-data div for server-side -->

{% endif %} <!-- Close results_capped if -->

<!-- API Equivalent Component -->
<div class="api-equivalent" id="api-equivalent" x-data="{ activeTab: 'url' }">
    <h3>API Equivalent</h3>
    <p>Use these requests to get the same data programmatically:</p>

    <div class="code-tab-buttons">
        <button
            class="code-tab-btn"
            :class="{ active: activeTab === 'url' }"
            @click="activeTab = 'url'"
            role="tab"
            :aria-selected="(activeTab === 'url').toString()">
            URL
        </button>
        <button
            class="code-tab-btn"
            :class="{ active: activeTab === 'curl' }"
            @click="activeTab = 'curl'"
            role="tab"
            :aria-selected="(activeTab === 'curl').toString()">
            cURL
        </button>
        <button
            class="code-tab-btn"
            :class="{ active: activeTab === 'python' }"
            @click="activeTab = 'python'"
            role="tab"
            :aria-selected="(activeTab === 'python').toString()">
            Python
        </button>
    </div>

    <div class="code-tab-content" :class="{ active: activeTab === 'url' }" x-cloak>
        <div class="code-block">
            <button class="copy-btn" onclick="copyToClipboard(this.nextElementSibling.textContent)" aria-label="Copy to clipboard">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
            </button>
<pre><code>{{ request.url.scheme }}://{{ request.url.netloc }}/graphs?{% for key, value in query_params.items() %}{% if value is not string and value is iterable %}{% for v in value %}{{ key }}={{ v }}{% if not loop.last %}&{% endif %}{% endfor %}{% else %}{{ key }}={{ value }}{% endif %}{% if not loop.last %}&{% endif %}{% endfor %}&limit={{ limit }}{% if page > 1 %}&page={{ page }}{% endif %}</code></pre>
        </div>
    </div>

    <div class="code-tab-content" :class="{ active: activeTab === 'curl' }" x-cloak>
        <div class="code-block">
            <button class="copy-btn" onclick="copyToClipboard(this.nextElementSibling.textContent)" aria-label="Copy to clipboard">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
            </button>
<pre><code>curl '{{ request.url.scheme }}://{{ request.url.netloc }}/graphs?{% for key, value in query_params.items() %}{% if value is not string and value is iterable %}{% for v in value %}{{ key }}={{ v }}{% if not loop.last %}&{% endif %}{% endfor %}{% else %}{{ key }}={{ value }}{% endif %}{% if not loop.last %}&{% endif %}{% endfor %}&limit={{ limit }}{% if page > 1 %}&page={{ page }}{% endif %}' \
  -H 'Accept: application/json'</code></pre>
        </div>
    </div>

    <div class="code-tab-content" :class="{ active: activeTab === 'python' }" x-cloak>
        <div class="code-block">
            <button class="copy-btn" onclick="copyToClipboard(this.nextElementSibling.textContent)" aria-label="Copy to clipboard">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
            </button>
<pre><code>import requests

response = requests.get(
    '{{ request.url.scheme }}://{{ request.url.netloc }}/graphs',
    params={
        {% for key, value in query_params.items() %}{% if value is not string and value is iterable %}'{{ key }}': {{ value | tojson }},
        {% else %}'{{ key }}': {{ value | tojson }},
        {% endif %}{% endfor %}'limit': {{ limit }},
        {% if page > 1 %}'page': {{ page }},{% endif %}
    }
)
graphs = response.json()</code></pre>
        </div>
    </div>
</div>

{% else %}
<p><em>No graphs found matching your criteria.</em></p>
{% endif %}

<script>
function copyToClipboard(text) {
    const btn = event.target.closest('.copy-btn');
    navigator.clipboard.writeText(text).then(() => {
        btn.classList.add('copied');
        setTimeout(() => btn.classList.remove('copied'), 1500);
    });
}
</script>

{% endblock %}
